# ISCTE Timetable Optimiser ğŸ—“ï¸âš™ï¸

Micro-serviÃ§o em **Python 3.11 + FastAPI + pymoo** que gera horÃ¡rios nÃ£o-dominados
para o ISCTE recorrendo ao algoritmo **NSGA-II**.

> Componente independente do sistema â€œGestÃ£o de HorÃ¡riosâ€; comunica via
> HTTP / JSON com o backend Node.

---

## âœ¨ Funcionalidades

* **`POST /optimise`**  
  â€¢ recebe dados de turmas, salas e *time-slots* em JSON  
  â€¢ devolve a _frente de Pareto_ com mÃ©tricas (`conflicts`, `crowding`, `gaps`)

* **TraceCallback** grava hyper-volume por geraÃ§Ã£o em ficheiro  
* Esquemas Pydantic â‡’ documentaÃ§Ã£o Swagger automÃ¡tica  
* Pronto para correr em `docker-compose`

---

## ğŸ“‚ Estrutura

optimiser/
â”œâ”€ api.py # FastAPI + endpoint /optimise
â”œâ”€ model.py # TimetableProblem (pymoo)
â”œâ”€ callbacks.py # TraceCallback (logging HV)
â”œâ”€ datagen.py # gera dados dummy para testes rÃ¡pidos
â”œâ”€ requirements.txt
â””â”€ Dockerfile

yaml
Copiar
Editar

---

## âš¡ InstalaÃ§Ã£o rÃ¡pida (local)

```bash
git clone <repo> && cd optimiser
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

# arrancar servidor
uvicorn api:app --reload --port 8000
Swagger UI: http://localhost:8000/docs

Recarrega automaticamente graÃ§as a --reload.

ğŸ‹ Docker
bash
Copiar
Editar
docker build -t iscte-optimiser .
docker run -p 8000:8000 iscte-optimiser
docker-compose.yml de exemplo:

yaml
Copiar
Editar
services:
  optimiser:
    build: ./optimiser
    ports:
      - "8000:8000"
ğŸ”Œ EspecificaÃ§Ã£o do endpoint
Request
jsonc
Copiar
Editar
POST /optimise
Content-Type: application/json

{
  "data": {
    "classes": [
      {
        "id": 17,
        "size": 28,
        "prof": 4,
        "year": 1,
        "duration": 2,
        "reqFeatures": ["Lab"]
      }
      /* â€¦ */
    ],
    "rooms": [
      { "id": 12, "capacity": 40, "features": ["Lab", "Proj"] }
      /* â€¦ */
    ],
    "slots": [
      { "id": 0, "day": "Mon", "start": "08:00" }
      /* â€¦ */
    ]
  },
  "pop_size": 200,   // opcional (default 200)
  "n_gen":    400    // opcional (default 400)
}
Response
json
Copiar
Editar
{
  "pareto": [
    {
      "id": 0,
      "allocation": [
        { "class_id": 17, "slot_id": 3, "room_id": 12 },
        { "class_id": 18, "slot_id": 7, "room_id":  8 }
        /* â€¦ */
      ],
      "metrics": {
        "conflicts": 0,
        "crowding":  14,
        "gaps":       2
      }
    }
    /* â€¦ */
  ]
}
ğŸ”§ PersonalizaÃ§Ã£o
Onde	O quÃª
model.py	FÃ³rmula de avaliaÃ§Ã£o, nÂº de objectivos, restriÃ§Ãµes
callbacks.py	Ref-point e formato de log (hyper-volume)
Body do POST /optimise	pop_size, n_gen, etc.

ğŸ§ª Teste rÃ¡pido (dummy)
bash
Copiar
Editar
python - <<'PY'
from datagen import generate_dummy_payload
from api import optimise, OptimiseIn
resp = optimise(OptimiseIn(data=generate_dummy_payload()))
print(resp.json(indent=2))
PY
ğŸ—ºï¸ Roadmap curto
 Permitir escolha de algoritmo (GA, PSO, â€¦) via query-param

 Exportar CSV/PDF da melhor soluÃ§Ã£o

 MÃ©trica de adequaÃ§Ã£o de caracterÃ­sticas da sala

 Persistir logs para anÃ¡lise offline

ğŸ“œ LicenÃ§a
MIT Â© 2024 â€“ Mestrado em Engenharia InformÃ¡tica â€¢ ISCTE-IUL